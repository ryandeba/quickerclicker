<!DOCTYPE html>
<html>
	<head>
		<link href="bower_components/bootstrap/dist/css/bootstrap.css" rel="stylesheet" />
		<link href="application.css" rel="stylesheet" />
		<script src="bower_components/jquery/jquery.js"></script>
		<script src="bower_components/underscore/underscore.js"></script>
		<script src="bower_components/backbone/backbone.js"></script>
		<script src="bower_components/marionette/lib/backbone.marionette.js"></script>

		<script src="QuickerClicker.js"></script>
		<script src="ClickerCatcher.js"></script>
		<script src="Click.js"></script>
		<script src="Game.js"></script>
		<script>
			$(function(){
				QuickerClicker.addRegions({
					mainRegion: "#quickerclicker",
					clickerCatcherRegion: "#clickercatcher"
				});

				var clickerCatcher = new QuickerClicker.ClickerCatcher();
				var clickerCatcherView = new QuickerClicker.ClickerCatcherView({
					model: clickerCatcher
				});

				QuickerClicker.newGame = function(){
					var game = new QuickerClicker.Game();
					var gameView = new QuickerClicker.GameView({
						model: game
					});

					this.listenTo(clickerCatcher, "click", function(){game.addClick();});

					this.listenTo(game, "gameOver", this.gameEnd);

					this.mainRegion.show(gameView);
					this.clickerCatcherRegion.show(clickerCatcherView);
				};

				QuickerClicker.gameEnd = function(){
					this.stopListening(clickerCatcher);
					this.clickerCatcherRegion.reset();
				};

				QuickerClicker.on("initialize:after", function(){
					this.newGame();
				});

				QuickerClicker.start();
			});
		</script>
	</head>
	<body>

		<header class="navbar navbar-inverse navbar-fixed-top">
			<div class="container">
				<div class="navbar-header">
					<a href="/" class="navbar-brand">Quicker Clicker</a>
				</div>
			</div>
		</header>

		<div id="quickerclicker" class="container"></div>
		<div id="clickercatcher"></div>

		<script type="text/template" id="menu-template">
			<div class="row">
				<div class="col-xs-6 col-xs-offset-3">
					<button class="btn btn-primary js-start-game">Start Game</button>
				</div>
			</div>
			<div class="row">
				<ol class="col-xs-8 col-xs-offset-4 text-left">
					<li>Clicks per second: <%= clicksPerSecond %></li>
					<li>Total number of clicks: <%= numberOfClicks %></li>
					<li>Time to first click: <%= (millisecondsToFirstClick / 1000).toFixed(3) %> seconds</li>
					<li>Fastest click: <%= (millisecondsOfFastestClick / 1000).toFixed(3) %> seconds</li>
				</ol>
			</div>
		</script>

		<script type="text/template" id="game-template">
			<div class="row">
				<div class="col-xs-12">
					<span style="font-size: 140px;"><%= clicksPerSecond.toFixed(4) %></span>
					clicks per second
				</div>
			</div>

			<% var progressBarClass = "success" %>
			<% progressBarClass = percentOfTimeRemaining < 80 ? "info" : progressBarClass %>
			<% progressBarClass = percentOfTimeRemaining < 40 ? "warning" : progressBarClass %>
			<% progressBarClass = percentOfTimeRemaining < 10 ? "danger" : progressBarClass %>
			<div class="row">
				<div class="col-xs-12">
					<div class="progress progress-striped">
						<div class="progress-bar progress-bar-<%= progressBarClass %>" style="width: <%= percentOfTimeRemaining %>%;"></div>
					</div>
				</div>
			</div>
		</script>

		<script type="text/template" id="clickercatcher-template">
		</script>

		<!-- <div id="clickercatcher"></div> -->

	</body>
</html>
